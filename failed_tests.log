FAIL test/unit/logger.test.js
  ‚óè Console

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:28.870Z - [INFO]: MapCap Audit Engine Synchronized for Cloud Deployment.
      [0m

      at log (src/config/logger.js:58:17)

  ‚óè Audit Logger Engine - Unit Tests ‚Ä∫ Environment: Should verify logger synchronization message on boot

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "MapCap Audit Engine Synchronized"

    Number of calls: 0

      64 |   test('Environment: Should verify logger synchronization message on boot', () => {
      65 |     // The file writes an initial log on import
    > 66 |     expect(console.log).toHaveBeenCalledWith(
         |                         ^
      67 |       expect.stringContaining('MapCap Audit Engine Synchronized')
      68 |     );
      69 |   });

      at Object.toHaveBeenCalledWith (test/unit/logger.test.js:66:25)

(node:14261) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL test/unit/settlement_job.test.js
  ‚óè Console

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:29.363Z - [INFO]: MapCap Audit Engine Synchronized for Cloud Deployment.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      --- [COMPLIANCE] Starting Final Whale Settlement & Refund Cycle ---

      at SettlementJob.log [as executeWhaleTrimBack] (src/jobs/settlement.job.js:26:17)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:29.447Z - [INFO]: Whale Settlement Initiated. Pool: 100000 Pi
      [0m

      at log (src/config/logger.js:58:17)

    console.warn
      [WHALE_DETECTED] Wallet: Whale_Pioneer_001 | Excess: 5000.555555 Pi

      43 |                 const preciseRefund = MathHelper.toPiPrecision(excessAmount);
      44 |
    > 45 |                 console.warn(`[WHALE_DETECTED] Wallet: ${investor.piAddress} | Excess: ${preciseRefund} Pi`);
         |                         ^
      46 |
      47 |                 try {
      48 |                     /**

      at SettlementJob.warn [as executeWhaleTrimBack] (src/jobs/settlement.job.js:45:25)
      at Object.executeWhaleTrimBack (test/unit/settlement_job.test.js:44:40)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:29.460Z - [INFO]: Settlement Success: 5000.555555 Pi refunded to Whale_Pioneer_001. Capped at 10%.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      --- [SUMMARY] Settlement Complete. Total Recovered: 5000.555555 Pi | Whales Impacted: 1 ---

      at SettlementJob.log [as executeWhaleTrimBack] (src/jobs/settlement.job.js:84:17)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:29.465Z - [INFO]: Settlement Complete. Total Recovered: 5000.555555 Pi | Whales Impacted: 1
      [0m

      at log (src/config/logger.js:58:17)

--
      [31m[AUDIT_ALERT] 2026-02-13T17:05:29.602Z - [CRITICAL]: SETTLEMENT_FAILURE for Whale_A: Network Congestion
      [0m

      54 |     // Critical console output for real-time monitoring via Vercel Logs
      55 |     if (level === 'CRITICAL' || level === 'ERROR' || level === 'WARN') {
    > 56 |         console.error(`\x1b[31m[AUDIT_ALERT] ${entry}\x1b[0m`);
         |                 ^
      57 |     } else {
      58 |         console.log(`\x1b[32m[AUDIT_INFO] ${entry}\x1b[0m`);
      59 |     }

      at error (src/config/logger.js:56:17)
      at SettlementJob.writeAuditLog [as executeWhaleTrimBack] (src/jobs/settlement.job.js:75:21)
      at Object.<anonymous> (test/unit/settlement_job.test.js:89:5)

    console.error
      [CRITICAL_SETTLEMENT_FAILURE] Network Congestion

      74 |                      */
      75 |                     writeAuditLog('CRITICAL', `SETTLEMENT_FAILURE for ${investor.piAddress}: ${error.message}`);
    > 76 |                     console.error(`[CRITICAL_SETTLEMENT_FAILURE]`, error.message);
         |                             ^
      77 |                 }
      78 |             }
      79 |         }

      at SettlementJob.error [as executeWhaleTrimBack] (src/jobs/settlement.job.js:76:29)
      at Object.<anonymous> (test/unit/settlement_job.test.js:89:5)

    console.warn
      [WHALE_DETECTED] Wallet: Whale_B | Excess: 10000 Pi

      43 |                 const preciseRefund = MathHelper.toPiPrecision(excessAmount);
      44 |
    > 45 |                 console.warn(`[WHALE_DETECTED] Wallet: ${investor.piAddress} | Excess: ${preciseRefund} Pi`);
         |                         ^
      46 |
      47 |                 try {
      48 |                     /**

      at SettlementJob.warn [as executeWhaleTrimBack] (src/jobs/settlement.job.js:45:25)
      at Object.<anonymous> (test/unit/settlement_job.test.js:89:5)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:29.608Z - [INFO]: Settlement Success: 10000 Pi refunded to Whale_B. Capped at 10%.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      --- [SUMMARY] Settlement Complete. Total Recovered: 10000 Pi | Whales Impacted: 1 ---

      at SettlementJob.log [as executeWhaleTrimBack] (src/jobs/settlement.job.js:84:17)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:29.611Z - [INFO]: Settlement Complete. Total Recovered: 10000 Pi | Whales Impacted: 1
      [0m

      at log (src/config/logger.js:58:17)

  ‚óè Settlement Job - High-Precision Logic Tests ‚Ä∫ Enforcement: Should accurately calculate and refund excess Pi using 6-decimal precision

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "Whale_Pioneer_001", 5000.555556
    Received: "Whale_Pioneer_001", 5000.555555

    Number of calls: 1

      45 |
      46 |     // 1. Check if the payout service was called with the exact excess
--
FAIL test/unit/price.test.js
  ‚óè MapCap Price Engine - Unit Tests ‚Ä∫ Spot Price: Should accurately calculate price based on total Pi liquidity

    expect(received).toBe(expected) // Object.is equality

    Expected: NaN
    Received: 21.81818

      24 |     const expected = supply / totalPiInvested; // 21.81818
      25 |     
    > 26 |     expect(PriceService.calculateDailySpotPrice(totalPiInvested)).toBe(expected);
         |                                                                   ^
      27 |   });
      28 |
      29 |   /**

      at Object.toBe (test/unit/price.test.js:26:67)

(node:14256) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL test/unit/daily_price_job.test.js (5.276 s)
  ‚óè Console

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:30.914Z - [INFO]: MapCap Audit Engine Synchronized for Cloud Deployment.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      --- [MARKET_ENGINE] Starting Daily Price Recalibration ---

      at DailyPriceJob.log [as updatePrice] (src/jobs/daily-price-update.js:23:17)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:31.042Z - [INFO]: [MARKET_SNAPSHOT] Pool: 100000 Pi | Spot Price: 21.818180 Pi/MapCap
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      [AUDIT] Total Pool Liquidity: 100000 Pi

      at DailyPriceJob.log [as updatePrice] (src/jobs/daily-price-update.js:50:21)

    console.log
      [AUDIT] Recalculated Spot Price: 21.818180

      at DailyPriceJob.log [as updatePrice] (src/jobs/daily-price-update.js:51:21)

    console.log
      --- [SUCCESS] Daily Price Update Cycle Completed ---

      at DailyPriceJob.log [as updatePrice] (src/jobs/daily-price-update.js:58:21)

    console.log
      --- [MARKET_ENGINE] Starting Daily Price Recalibration ---

      at DailyPriceJob.log [as updatePrice] (src/jobs/daily-price-update.js:23:17)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:31.153Z - [INFO]: [MARKET_SNAPSHOT] Pool: 0 Pi | Spot Price: 0.000000 Pi/MapCap
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      [AUDIT] Total Pool Liquidity: 0 Pi

      at DailyPriceJob.log [as updatePrice] (src/jobs/daily-price-update.js:50:21)

--
      [31m[AUDIT_ALERT] 2026-02-13T17:05:34.089Z - [CRITICAL]: Refund FAILED for Whale_1: Network Lag
      [0m

      54 |     // Critical console output for real-time monitoring via Vercel Logs
      55 |     if (level === 'CRITICAL' || level === 'ERROR' || level === 'WARN') {
    > 56 |         console.error(`\x1b[31m[AUDIT_ALERT] ${entry}\x1b[0m`);
         |                 ^
      57 |     } else {
      58 |         console.log(`\x1b[32m[AUDIT_INFO] ${entry}\x1b[0m`);
      59 |     }

      at error (src/config/logger.js:56:17)
      at writeAuditLog (src/jobs/refunds.job.js:66:17)
      at Object.<anonymous> (test/unit/refunds_job.test.js:90:20)

    console.error
      [CRITICAL_AUDIT_FAILURE] Payment Pipeline Error: Network Lag

      65 |                  */
      66 |                 writeAuditLog('CRITICAL', `Refund FAILED for ${investor.piAddress}: ${error.message}`);
    > 67 |                 console.error(`[CRITICAL_AUDIT_FAILURE] Payment Pipeline Error:`, error.message);
         |                         ^
      68 |             }
      69 |         }
      70 |     }

      at error (src/jobs/refunds.job.js:67:25)
      at Object.<anonymous> (test/unit/refunds_job.test.js:90:20)

    console.warn
      [WHALE_DETECTED] Pioneer: Whale_2 | Excess: 20000.0000 Pi

      39 |             const excessAmount = contribution - WHALE_CAP_LIMIT;
      40 |             
    > 41 |             console.warn(`[WHALE_DETECTED] Pioneer: ${investor.piAddress} | Excess: ${excessAmount.toFixed(4)} Pi`);
         |                     ^
      42 |             
      43 |             try {
      44 |                 /**

      at warn (src/jobs/refunds.job.js:41:21)
      at Object.<anonymous> (test/unit/refunds_job.test.js:90:20)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:34.096Z - [INFO]: Refund Successful: 20000 Pi returned to Whale_2
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:34.099Z - [INFO]: Anti-Whale Refund Completed. Total Refunded: 20000 Pi across 1 accounts.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      --- [SYSTEM] Process Finished. 1 Refunds issued. ---

      at log (src/jobs/refunds.job.js:75:13)

FAIL test/unit/server_heartbeat.test.js (7.932 s)
  ‚óè Console

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:33.521Z - [INFO]: MapCap Audit Engine Synchronized for Cloud Deployment.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      üöÄ [ENGINE] MapCap IPO Pulse deployed on port 3000

      at Server.log (server.js:137:17)

  ‚óè Server Engine - Heartbeat & Integration Tests ‚Ä∫ Resilience: Should trigger the Global Error Interceptor on failures

    expect(received).toHaveProperty(path)

    Expected path: "success"
    Received path: []

    Received value: {}

      63 |     
      64 |     // Testing the standardized ResponseHelper formatting
    > 65 |     expect(res.body).toHaveProperty('success');
         |                      ^
      66 |     expect(typeof res.body.success).toBe('boolean');
      67 |   });
      68 | });

      at Object.toHaveProperty (test/unit/server_heartbeat.test.js:65:22)

PASS test/unit/payment_controller.test.js
  ‚óè Console

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:35.188Z - [INFO]: MapCap Audit Engine Synchronized for Cloud Deployment.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:35.222Z - [INFO]: Investment Processed: 100 Pi from GBV...PIONEER_ADDR (TX: TXID_9988776655)
      [0m

      at log (src/config/logger.js:58:17)

    console.error
      [31m[AUDIT_ALERT] 2026-02-13T17:05:35.293Z - [ERROR]: [ERR-MLL52BLP-JIO] Code: 409 | Message: Duplicate Transaction: TXID already processed.
      [0m
--
FAIL test/unit/vesting_job.test.js (10.715 s)
  ‚óè Console

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:31.461Z - [INFO]: MapCap Audit Engine Synchronized for Cloud Deployment.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      üïí --- [VESTING_ENGINE] Monthly Distribution Cycle Started ---

      at VestingJob.log [as executeMonthlyVesting] (src/jobs/vesting.job.js:26:17)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:31.609Z - [INFO]: Vesting Engine: Monthly Tranche Release Initiated.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      üìä [SCAN] Found 1 eligible Pioneers for distribution.

      at VestingJob.log [as executeMonthlyVesting] (src/jobs/vesting.job.js:46:21)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:31.621Z - [INFO]: [TRANCHE_RELEASED] 1/10 | Recipient: Pioneer_001
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      ‚úÖ [SUCCESS] Tranche dispatched to: Pioneer_001

      at VestingJob.log [as executeMonthlyVesting] (src/jobs/vesting.job.js:74:33)

    console.log
      üèÅ --- [SUCCESS] Monthly Vesting Cycle Finalized ---

      at VestingJob.log [as executeMonthlyVesting] (src/jobs/vesting.job.js:88:21)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:31.626Z - [INFO]: Vesting Engine: Cycle finished successfully.
      [0m

      at log (src/config/logger.js:58:17)

    console.log
      üïí --- [VESTING_ENGINE] Monthly Distribution Cycle Started ---

      at VestingJob.log [as executeMonthlyVesting] (src/jobs/vesting.job.js:26:17)
--
      [31m[AUDIT_ALERT] 2026-02-13T17:05:36.719Z - [CRITICAL]: [PAYOUT_FAILURE] Identity: Pioneer_Err | Error: Network Fail
      [0m

      54 |     // Critical console output for real-time monitoring via Vercel Logs
      55 |     if (level === 'CRITICAL' || level === 'ERROR' || level === 'WARN') {
    > 56 |         console.error(`\x1b[31m[AUDIT_ALERT] ${entry}\x1b[0m`);
         |                 ^
      57 |     } else {
      58 |         console.log(`\x1b[32m[AUDIT_INFO] ${entry}\x1b[0m`);
      59 |     }

      at error (src/config/logger.js:56:17)
      at VestingJob.writeAuditLog [as executeMonthlyVesting] (src/jobs/vesting.job.js:82:25)
      at Object.<anonymous> (test/unit/vesting_job.test.js:97:5)

    console.error
      ‚ùå [PIPELINE_ERROR] Payment failed for Pioneer_Err: Network Fail

      81 |                          */
      82 |                         writeAuditLog('CRITICAL', `[PAYOUT_FAILURE] Identity: ${investor.piAddress} | Error: ${err.message}`);
    > 83 |                         console.error(`‚ùå [PIPELINE_ERROR] Payment failed for ${investor.piAddress}:`, err.message);
         |                                 ^
      84 |                     }
      85 |                 }
      86 |             }

      at VestingJob.error [as executeMonthlyVesting] (src/jobs/vesting.job.js:83:33)
      at Object.<anonymous> (test/unit/vesting_job.test.js:97:5)

    console.log
      üèÅ --- [SUCCESS] Monthly Vesting Cycle Finalized ---

      at VestingJob.log [as executeMonthlyVesting] (src/jobs/vesting.job.js:88:21)

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:36.727Z - [INFO]: Vesting Engine: Cycle finished successfully.
      [0m

      at log (src/config/logger.js:58:17)

  ‚óè Vesting Job - Monthly Release Logic Tests ‚Ä∫ Security: Should only fetch and process non-whale accounts

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      67 |    * Requirement: Automated vesting engine should only process non-whale accounts.
      68 |    */
    > 69 |   test('Security: Should only fetch and process non-whale accounts', async () => {
         |   ^
      70 |     const findSpy = jest.spyOn(Investor, 'find');
      71 |     
      72 |     await VestingJob.executeMonthlyVesting();

      at test (test/unit/vesting_job.test.js:69:3)
      at describe (test/unit/vesting_job.test.js:18:1)

PASS test/unit/ipo_controller.test.js
  ‚óè Console

    console.log
      [32m[AUDIT_INFO] 2026-02-13T17:05:37.579Z - [INFO]: MapCap Audit Engine Synchronized for Cloud Deployment.
      [0m

      at log (src/config/logger.js:58:17)

    console.error
      [CRITICAL_CONTROLLER_ERROR]: DB_OFFLINE

      88 |
      89 |         } catch (error) {
--
FAIL test/unit/transaction_model.test.js
  ‚óè Test suite failed to run

    ReferenceError: require is not defined

      11 |  */
      12 |
    > 13 | const Transaction = require('../../src/models/Transaction');
         |                     ^
      14 | const mongoose = require('mongoose');
      15 |
      16 | describe('Transaction Model - Ledger Integrity Tests', () => {

      at require (test/unit/transaction_model.test.js:13:21)

PASS test/unit/package_integrity.test.js

  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "[31m[AUDIT_ALERT] 2026-02-13T17:05:41.937Z - [CRITICAL]: [FATAL_SYSTEM_ERROR] Vesting Job Aborted: Operation `investors.find()` buffering timed out after 10000ms
    [0m".

      54 |     // Critical console output for real-time monitoring via Vercel Logs
      55 |     if (level === 'CRITICAL' || level === 'ERROR' || level === 'WARN') {
    > 56 |         console.error(`\x1b[31m[AUDIT_ALERT] ${entry}\x1b[0m`);
         |                 ^
      57 |     } else {
      58 |         console.log(`\x1b[32m[AUDIT_INFO] ${entry}\x1b[0m`);
      59 |     }

      at console.error (node_modules/@jest/console/build/BufferedConsole.js:127:10)
      at error (src/config/logger.js:56:17)
      at VestingJob.writeAuditLog [as executeMonthlyVesting] (src/jobs/vesting.job.js:92:13)
      at Object.<anonymous> (test/unit/vesting_job.test.js:72:5)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "üö® [ENGINE_FAILURE] Vesting Job Critical Crash: Operation `investors.find()` buffering timed out after 10000ms".

      91 |         } catch (error) {
      92 |             writeAuditLog('CRITICAL', `[FATAL_SYSTEM_ERROR] Vesting Job Aborted: ${error.message}`);
    > 93 |             console.error("üö® [ENGINE_FAILURE] Vesting Job Critical Crash:", error.message);
         |                     ^
      94 |             throw error; // Propagate to global error handler
      95 |         }
      96 |     }

      at console.error (node_modules/@jest/console/build/BufferedConsole.js:127:10)
      at VestingJob.error [as executeMonthlyVesting] (src/jobs/vesting.job.js:93:21)
      at Object.<anonymous> (test/unit/vesting_job.test.js:72:5)

FAIL test/unit/investor_model.test.js
  ‚óè Test suite failed to run

    ReferenceError: require is not defined

      11 |  */
      12 |
    > 13 | const Investor = require('../../src/models/Investor');
         |                  ^
      14 | const mongoose = require('mongoose');
      15 |
      16 | describe('Investor Model - Schema Integrity Tests', () => {

      at require (test/unit/investor_model.test.js:13:18)

FAIL test/unit/settlement_logic.test.js
  ‚óè Test suite failed to run

    ReferenceError: require is not defined

      16 |
      17 | // Mocking PayoutService to avoid real blockchain interaction
    > 18 | jest.mock('../../src/services/payout.service');
         |                                                ^
      19 |
      20 | describe('Settlement Job - Anti-Whale Logic Tests', () => {
      21 |

      at require (test/unit/settlement_logic.test.js:18:48)
      at _getJestObj (test/unit/settlement_logic.test.js:18:1)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "‚úÖ [DATABASE] Financial Ledger: Connection Established".

      55 |             useUnifiedTopology: true,
      56 |         });
    > 57 |         console.log('‚úÖ [DATABASE] Financial Ledger: Connection Established');
         |                 ^
      58 |         writeAuditLog('INFO', 'Database Connection Established.');
      59 |
      60 |         // Bootstrap cron jobs in development/staging environments

      at console.log (node_modules/@jest/console/build/BufferedConsole.js:156:10)
      at log (server.js:57:17)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "[32m[AUDIT_INFO] 2026-02-13T17:05:42.568Z - [INFO]: Database Connection Established.
    [0m".

      56 |         console.error(`\x1b[31m[AUDIT_ALERT] ${entry}\x1b[0m`);
      57 |     } else {
    > 58 |         console.log(`\x1b[32m[AUDIT_INFO] ${entry}\x1b[0m`);
         |                 ^
      59 |     }
      60 | };
      61 |

      at console.log (node_modules/@jest/console/build/BufferedConsole.js:156:10)
      at log (src/config/logger.js:58:17)
      at writeAuditLog (server.js:58:9)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "--- [SYSTEM] Cron Scheduler Initialized (UTC Mode) ---".
--
FAIL test/unit/admin_routes.test.js
  ‚óè Test suite failed to run

    Cannot find module '../../controllers/admin/auth.controller.js' from 'test/unit/admin_routes.test.js'

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)


ReferenceError: You are trying to `import` a file after the Jest environment has been torn down. From test/unit/admin_routes.test.js.



ReferenceError: You are trying to `import` a file after the Jest environment has been torn down. From test/unit/admin_routes.test.js.



ReferenceError: You are trying to `import` a file after the Jest environment has been torn down. From test/unit/admin_routes.test.js.



ReferenceError: You are trying to `import` a file after the Jest environment has been torn down. From test/unit/admin_routes.test.js.


FAIL test/unit/cron_scheduler.test.js
  ‚óè Test suite failed to run

    ReferenceError: require is not defined

      20 | jest.mock('node-cron', () => ({
      21 |   schedule: jest.fn()
    > 22 | }));
         |     ^
      23 |
      24 | describe('Cron Scheduler - Automation Logic Tests', () => {
      25 |   

      at require (test/unit/cron_scheduler.test.js:22:5)
      at _getJestObj (test/unit/cron_scheduler.test.js:20:1)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Summary of all failing tests
FAIL test/unit/logger.test.js
  ‚óè Audit Logger Engine - Unit Tests ‚Ä∫ Environment: Should verify logger synchronization message on boot

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "MapCap Audit Engine Synchronized"

    Number of calls: 0

      64 |   test('Environment: Should verify logger synchronization message on boot', () => {
      65 |     // The file writes an initial log on import
    > 66 |     expect(console.log).toHaveBeenCalledWith(
         |                         ^
      67 |       expect.stringContaining('MapCap Audit Engine Synchronized')
      68 |     );
      69 |   });

      at Object.toHaveBeenCalledWith (test/unit/logger.test.js:66:25)

FAIL test/unit/settlement_job.test.js
  ‚óè Settlement Job - High-Precision Logic Tests ‚Ä∫ Enforcement: Should accurately calculate and refund excess Pi using 6-decimal precision

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "Whale_Pioneer_001", 5000.555556
    Received: "Whale_Pioneer_001", 5000.555555

    Number of calls: 1

      45 |
      46 |     // 1. Check if the payout service was called with the exact excess
    > 47 |     expect(PayoutService.executeA2UPayout).toHaveBeenCalledWith(
         |                                            ^
      48 |         'Whale_Pioneer_001', 
      49 |         5000.555556 // Based on 6-decimal MathHelper precision logic
      50 |     );

      at Object.toHaveBeenCalledWith (test/unit/settlement_job.test.js:47:44)

FAIL test/unit/price.test.js
  ‚óè MapCap Price Engine - Unit Tests ‚Ä∫ Spot Price: Should accurately calculate price based on total Pi liquidity

    expect(received).toBe(expected) // Object.is equality

    Expected: NaN
    Received: 21.81818

      24 |     const expected = supply / totalPiInvested; // 21.81818
      25 |     
    > 26 |     expect(PriceService.calculateDailySpotPrice(totalPiInvested)).toBe(expected);
         |                                                                   ^
      27 |   });
      28 |
      29 |   /**

      at Object.toBe (test/unit/price.test.js:26:67)

FAIL test/unit/daily_price_job.test.js (5.276 s)
  ‚óè Daily Price Job - Market Logic Tests ‚Ä∫ Recalibration: Should calculate and return the correct spot price based on liquidity

    expect(received).toBe(expected) // Object.is equality

    Expected: "21.8182"
    Received: "21.818180"

      36 |     // 2,181,818 / 100,000 = 21.81818
      37 |     expect(result.totalPiInvested).toBe(100000);
    > 38 |     expect(result.newPrice).toBe("21.8182"); // Based on PriceService 4-decimal formatting
         |                             ^
      39 |   });
      40 |
      41 |   /**

      at Object.toBe (test/unit/daily_price_job.test.js:38:29)

  ‚óè Daily Price Job - Market Logic Tests ‚Ä∫ Safety: Should return a price of 0 when total liquidity is zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0.0000"
    Received: "0.000000"

      49 |
      50 |     expect(result.totalPiInvested).toBe(0);
    > 51 |     expect(result.newPrice).toBe("0.0000");
         |                             ^
      52 |   });
      53 |
      54 |   /**

      at Object.toBe (test/unit/daily_price_job.test.js:51:29)

FAIL test/unit/server_heartbeat.test.js (7.932 s)
  ‚óè Server Engine - Heartbeat & Integration Tests ‚Ä∫ Resilience: Should trigger the Global Error Interceptor on failures

    expect(received).toHaveProperty(path)

    Expected path: "success"
    Received path: []

    Received value: {}

      63 |     
      64 |     // Testing the standardized ResponseHelper formatting
    > 65 |     expect(res.body).toHaveProperty('success');
         |                      ^
      66 |     expect(typeof res.body.success).toBe('boolean');
      67 |   });
      68 | });

      at Object.toHaveProperty (test/unit/server_heartbeat.test.js:65:22)

FAIL test/unit/vesting_job.test.js (10.715 s)
  ‚óè Vesting Job - Monthly Release Logic Tests ‚Ä∫ Security: Should only fetch and process non-whale accounts

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      67 |    * Requirement: Automated vesting engine should only process non-whale accounts.
      68 |    */
    > 69 |   test('Security: Should only fetch and process non-whale accounts', async () => {
         |   ^
      70 |     const findSpy = jest.spyOn(Investor, 'find');
      71 |     
      72 |     await VestingJob.executeMonthlyVesting();

      at test (test/unit/vesting_job.test.js:69:3)
      at describe (test/unit/vesting_job.test.js:18:1)

FAIL test/unit/transaction_model.test.js
  ‚óè Test suite failed to run

    ReferenceError: require is not defined

      11 |  */
      12 |
    > 13 | const Transaction = require('../../src/models/Transaction');
         |                     ^
      14 | const mongoose = require('mongoose');
      15 |
      16 | describe('Transaction Model - Ledger Integrity Tests', () => {

      at require (test/unit/transaction_model.test.js:13:21)

FAIL test/unit/investor_model.test.js
  ‚óè Test suite failed to run

    ReferenceError: require is not defined

      11 |  */
      12 |
    > 13 | const Investor = require('../../src/models/Investor');
         |                  ^
      14 | const mongoose = require('mongoose');
      15 |
      16 | describe('Investor Model - Schema Integrity Tests', () => {

      at require (test/unit/investor_model.test.js:13:18)

FAIL test/unit/settlement_logic.test.js
  ‚óè Test suite failed to run

    ReferenceError: require is not defined

      16 |
      17 | // Mocking PayoutService to avoid real blockchain interaction
    > 18 | jest.mock('../../src/services/payout.service');
         |                                                ^
      19 |
      20 | describe('Settlement Job - Anti-Whale Logic Tests', () => {
      21 |

      at require (test/unit/settlement_logic.test.js:18:48)
      at _getJestObj (test/unit/settlement_logic.test.js:18:1)

FAIL test/unit/admin_routes.test.js
  ‚óè Test suite failed to run

    Cannot find module '../../controllers/admin/auth.controller.js' from 'test/unit/admin_routes.test.js'

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)

FAIL test/unit/cron_scheduler.test.js
  ‚óè Test suite failed to run

    ReferenceError: require is not defined

      20 | jest.mock('node-cron', () => ({
      21 |   schedule: jest.fn()
    > 22 | }));
         |     ^
      23 |
      24 | describe('Cron Scheduler - Automation Logic Tests', () => {
      25 |   

      at require (test/unit/cron_scheduler.test.js:22:5)
      at _getJestObj (test/unit/cron_scheduler.test.js:20:1)


Test Suites: 11 failed, 28 passed, 39 total
Tests:       7 failed, 105 passed, 112 total
Snapshots:   0 total
Time:        19.527 s
Ran all test suites.
